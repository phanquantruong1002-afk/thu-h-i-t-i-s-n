<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Điền khung → Xuất PDF</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>Điền khung → Xuất PDF (tải về)</h1>
      <p class="sub">
        Web dùng <b>template.docx</b> (chính là file Word bạn gửi) làm mẫu, thay placeholder <code>(1)…(17)</code>
        rồi xuất PDF tải về. (Không hiện màn “Xem trước”.)
      </p>
    </header>

    <section class="card">
      <h2>0) Chọn mẫu (tuỳ chọn)</h2>
      <p class="hint">Mặc định dùng <code>template.docx</code> trong repo. Nếu muốn dùng mẫu khác, chọn ở đây.</p>
      <div class="row">
        <input id="templateFile" type="file" accept=".docx" />
        <button id="btnUseDefault" type="button">Dùng template.docx</button>
        <span id="templateStatus" class="status">Đang dùng: template.docx</span>
      </div>
    </section>

    <section class="card">
      <h2>1) Các khung điền</h2>
      <form id="form">
        <div class="grid">
          <label>(1) Ngày <input name="d1" placeholder="05" required></label>
          <label>(2) Tháng <input name="d2" placeholder="11" required></label>
          <label>(3) Năm <input name="d3" placeholder="2025" required></label>

          <label>(4) Kính gửi (Ông/Bà) <input name="p4" placeholder="Nguyễn Văn Thanh" required></label>
          <label class="span2">(5) Địa chỉ <input name="p5" placeholder="..." required></label>

          <label>(6) Số hợp đồng <input name="p6" placeholder="20285167926" required></label>
          <label>(7) Ngày hợp đồng (dd/mm/yyyy) <input name="p7" placeholder="24/02/2022" required></label>

          <label class="span2">(9) Tài sản (mô tả xe) <input name="p9" placeholder="..." required></label>
          <label>(10) Số khung <input name="p10" placeholder="..." required></label>
          <label>(11) Số máy <input name="p11" placeholder="..." required></label>
          <label>(12) Biển số <input name="p12" placeholder="..." required></label>

          <label>(13) Số đăng ký xe <input name="p13" placeholder="..." required></label>
          <label>(14) Ngày cấp đăng ký <input name="p14" placeholder="..." required></label>

          <label>(15) Người liên hệ <input name="p15" placeholder="..." required></label>
          <label class="span2">(16) Chức vụ <input name="p16" placeholder="..." required></label>
          <label>(17) Di động <input name="p17" placeholder="..." required></label>

          <label class="span2">Tên file PDF <input name="outName" value="Thong-bao-thu-hoi-tai-san.pdf" /></label>
        </div>

        <div class="row">
          <button id="btnGenerate" type="submit">Tạo PDF</button>
          <button id="btnFillDemo" type="button">Điền demo</button>
          <span id="msg" class="status"></span>
        </div>
      </form>
    </section>

    <footer class="footer">
      <p>
        Ghi chú: GitHub Pages là web tĩnh nên PDF được tạo theo cách <b>DOCX → HTML (mammoth) → PDF (html2pdf)</b>.
        Nếu bạn cần PDF giống Word 100% (giữ nguyên layout/phông/bảng), bắt buộc phải có <b>server</b> convert (LibreOffice/OnlyOffice). <span class="ver">ver 0.2</span></p>
    </footer>
  </div>

  <!-- Vùng render ẩn để xuất PDF (không hiển thị) -->
  <div id="exportHost" class="exportHost" aria-hidden="true"></div>

  <!-- Overlay che màn hình khi xuất PDF (để exportHost có thể "hiện" mà người dùng không thấy) -->
  <div id="loadingOverlay" class="loadingOverlay" hidden>
    <div class="loadingBox">
      <div class="spinner"></div>
      <div>Đang tạo PDF…</div>
    </div>
  </div>

  <!-- Libs -->
  <script src="https://unpkg.com/pizzip@3.1.5/dist/pizzip.min.js"></script>
  <script src="https://unpkg.com/mammoth@1.6.0/mammoth.browser.min.js"></script>
  <script src="https://unpkg.com/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>

  <script src="./app.js"></script>
</body>
</html>
